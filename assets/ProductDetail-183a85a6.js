import{p as A,l as F,g as T,f as j,h as t,aU as X,v as N,aV as z,c as R,C as G,I as H,aG as J,q as O,z as W,t as y,aH as Y,A as Z,aI as K,J as U,ac as Q,a2 as $,i as ee,_ as ae,aW as te,S as se,T as re,U as le,r as P,w as oe,o as ie,X as ne,Y as x,Z as D,a0 as n,aX as ue,ab as ce,a7 as g,af as M,a3 as de,a5 as B,a8 as S,a4 as V,al as me,am as ve,V as L,a9 as fe,aa as be}from"./index-87fd04c1.js";import{u as ge,a as pe}from"./vee-validate.esm-1265a7f2.js";import{c as he,d as _e}from"./index.esm-639fe0e0.js";import{V as ye}from"./VContainer-139ab509.js";import{V as Ve,a as q}from"./VRow-7c709c95.js";import{V as Ce}from"./VTable-f4cb70ca.js";import{V as ke}from"./VDivider-0f572634.js";import{V as Be}from"./VForm-788ab327.js";const Se=A({divider:[Number,String],...F()},"VBreadcrumbsDivider"),we=T()({name:"VBreadcrumbsDivider",props:Se(),setup(e,p){let{slots:a}=p;return j(()=>{var v;return t("li",{class:["v-breadcrumbs-divider",e.class],style:e.style},[((v=a==null?void 0:a.default)==null?void 0:v.call(a))??e.divider])}),{}}}),Ie=A({active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...F(),...X(),...N({tag:"li"})},"VBreadcrumbsItem"),Pe=T()({name:"VBreadcrumbsItem",props:Ie(),setup(e,p){let{slots:a,attrs:v}=p;const f=z(e,v),u=R(()=>{var c;return e.active||((c=f.isActive)==null?void 0:c.value)}),h=R(()=>u.value?e.activeColor:e.color),{textColorClasses:s,textColorStyles:o}=G(h);return j(()=>t(e.tag,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":u.value,"v-breadcrumbs-item--disabled":e.disabled,[`${e.activeClass}`]:u.value&&e.activeClass},s.value,e.class],style:[o.value,e.style],"aria-current":u.value?"page":void 0},{default:()=>{var c,_;return[f.isLink.value?t("a",{class:"v-breadcrumbs-item--link",href:f.href.value,"aria-current":u.value?"page":void 0,onClick:f.navigate},[((_=a.default)==null?void 0:_.call(a))??e.title]):((c=a.default)==null?void 0:c.call(a))??e.title]}})),{}}}),xe=A({activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:H,items:{type:Array,default:()=>[]},...F(),...J(),...O(),...N({tag:"ul"})},"VBreadcrumbs"),De=T()({name:"VBreadcrumbs",props:xe(),setup(e,p){let{slots:a}=p;const{backgroundColorClasses:v,backgroundColorStyles:f}=W(y(e,"bgColor")),{densityClasses:u}=Y(e),{roundedClasses:h}=Z(e);K({VBreadcrumbsDivider:{divider:y(e,"divider")},VBreadcrumbsItem:{activeClass:y(e,"activeClass"),activeColor:y(e,"activeColor"),color:y(e,"color"),disabled:y(e,"disabled")}});const s=R(()=>e.items.map(o=>typeof o=="string"?{item:{title:o},raw:o}:{item:o,raw:o}));return j(()=>{const o=!!(a.prepend||e.icon);return t(e.tag,{class:["v-breadcrumbs",v.value,u.value,h.value,e.class],style:[f.value,e.style]},{default:()=>{var c;return[o&&t("li",{key:"prepend",class:"v-breadcrumbs__prepend"},[a.prepend?t(Q,{key:"prepend-defaults",disabled:!e.icon,defaults:{VIcon:{icon:e.icon,start:!0}}},a.prepend):t(U,{key:"prepend-icon",start:!0,icon:e.icon},null)]),s.value.map((_,d,k)=>{var C;let{item:m,raw:w}=_;return t($,null,[((C=a.item)==null?void 0:C.call(a,{item:m,index:d}))??t(Pe,ee({key:d,disabled:d>=k.length-1},typeof m=="string"?{title:m}:m),{default:a.title?()=>{var l;return(l=a.title)==null?void 0:l.call(a,{item:m,index:d})}:void 0}),d<k.length-1&&t(we,null,{default:a.divider?()=>{var l;return(l=a.divider)==null?void 0:l.call(a,{item:w,index:d})}:void 0})])}),(c=a.default)==null?void 0:c.call(a)]}})}),{}}});const E=e=>(fe("data-v-fd7ab33f"),e=e(),be(),e),qe={colspan:"3",class:"d-flex justify-center"},Re={class:"d-flex justify-center ma-2 pa-2"},$e={class:"my-2 font-weight-bold"},Ae={style:{"white-space":"pre"}},Fe=E(()=>g("h1",{class:"text-h1 text-red"},"已下架",-1)),Te=E(()=>g("br",null,null,-1)),je={__name:"ProductDetail",setup(e){const p=te(),a=se(),{api:v,apiAuth:f}=ce(),u=re(),h=le(),s=P({_id:"",name:"",price:0,description:"",images:[],sell:!0,category:""}),o=P(null);oe(()=>s.value.images,l=>{o.value=l[0]});const c=l=>{o.value=l},_=he({quantity:_e().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:d,handleSubmit:k}=ge({validationSchema:_,initialValues:{quantity:1}}),m=pe("quantity"),w=k(async l=>{var b,r;if(!h.isLogin){a.push("/login");return}try{const{data:i}=await f.patch("/users/cart",{product:s.value._id,quantity:l.quantity});h.cart=i.result,u({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"forth",location:"bottom"}})}catch(i){const I=((r=(b=i==null?void 0:i.response)==null?void 0:b.data)==null?void 0:r.message)||"發生錯誤，請稍後再試";u({text:I,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"seventh",location:"bottom"}})}}),C=P([]);return ie(async()=>{var l,b;try{const{data:r}=await v.get("/products/"+p.params.id);s.value._id=r.result._id,s.value.name=r.result.name,s.value.price=r.result.price,s.value.description=r.result.description,s.value.images=r.result.images,s.value.sell=r.result.sell,s.value.category=r.result.category,document.title=`發記冰品 | ${s.value.name}`,C.value=[{title:"首頁",disabled:!1,href:"/faji-front/#/"},{title:"快速預訂",disabled:!1,href:"/faji-front/#/product"},{title:`${s.value.name}`,disabled:!0,href:"/product#/product/"}]}catch(r){const i=((b=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:b.message)||"發生錯誤，請稍後再試";u({text:i,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"seventh",location:"bottom"}}),a.push("/")}}),(l,b)=>{const r=ne("font");return x(),D($,null,[t(ye,null,{default:n(()=>[t(Ve,null,{default:n(()=>[t(q,{cols:"12"},{default:n(()=>[t(De,{items:C.value},{divider:n(()=>[t(U,{icon:"mdi-chevron-right"})]),_:1},8,["items"])]),_:1}),t(q,{cols:"12",md:"6"},{default:n(()=>[t(Ce,null,{default:n(()=>[g("tr",null,[g("td",qe,[t(M,{width:350,height:350,"aspect-ratio":"1/1",cover:"",rounded:"lg",class:"mb-5 mx-5",src:o.value},null,8,["src"])])]),g("tr",Re,[(x(!0),D($,null,de(s.value.images,(i,I)=>(x(),D("td",{key:I},[t(M,{width:70,height:70,cover:"",rounded:"lg",src:i,onClick:Me=>c(i)},null,8,["src","onClick"])]))),128))])]),_:1})]),_:1}),t(q,{cols:"12",md:"6"},{default:n(()=>[g("h2",null,[t(r,{color:"#D92323"},{default:n(()=>[B("【"+S(s.value.category)+"】",1)]),_:1}),B(" "+S(s.value.name),1)]),t(ke),g("p",$e,"售價"+S(s.value.price),1),g("p",Ae,S(s.value.description),1),t(Be,{disabled:V(d),onSubmit:me(V(w),["prevent"])},{default:n(()=>[t(ve,{type:"number",min:"0",modelValue:V(m).value.value,"onUpdate:modelValue":b[0]||(b[0]=i=>V(m).value.value=i),modelModifiers:{number:!0},"error-messages":V(m).errorMessage.value,density:"confortable",variant:"outlined",placeholder:"數量",style:{width:"570px"}},null,8,["modelValue","error-messages"]),t(L,{type:"submit","prepend-icon":"mdi-cart",loading:V(d),style:{width:"570px"},color:"seventh"},{default:n(()=>[B("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),t(ue,{class:"align-center justify-center text-center","model-value":!s.value.sell,persistent:""},{default:n(()=>[Fe,Te,t(L,{to:"/",color:"third"},{default:n(()=>[B("回首頁")]),_:1})]),_:1},8,["model-value"])],64)}}},Je=ae(je,[["__scopeId","data-v-fd7ab33f"]]);export{Je as default};
