import{p as x,m as D,g as I,u as q,c as t,aT as j,a as F,aU as L,o as P,O as U,K as E,aH as O,e as W,h as G,t as y,aI as H,k as J,q as K,W as T,r as Y,a7 as M,G as Z,_ as z,aV as Q,Y as X,Z as ee,$ as ae,x as $,A as te,a1 as se,a2 as re,a3 as le,a5 as l,aW as oe,ag as ie,ac as o,V as B,aa as k,ad as S,a9 as V,am as ne,an as ue,J as A,ae as ce,af as de}from"./index-aa7f5d0f.js";import{u as me,a as ve}from"./vee-validate.esm-68a7d1a9.js";import{c as fe,d as be}from"./index.esm-639fe0e0.js";import{V as pe}from"./VContainer-d2b8c5e6.js";import{V as ge,a as w}from"./VRow-ad3aca82.js";import{V as _e}from"./VTable-105e9969.js";import{V as he}from"./VDivider-05f375fc.js";import{V as ye}from"./VForm-ef44dec7.js";const Ve=x({divider:[Number,String],...D()},"VBreadcrumbsDivider"),Ce=I()({name:"VBreadcrumbsDivider",props:Ve(),setup(e,p){let{slots:a}=p;return q(()=>{var v;return t("li",{class:["v-breadcrumbs-divider",e.class],style:e.style},[((v=a==null?void 0:a.default)==null?void 0:v.call(a))??e.divider])}),{}}}),ke=x({active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...D(),...j(),...F({tag:"li"})},"VBreadcrumbsItem"),Be=I()({name:"VBreadcrumbsItem",props:ke(),setup(e,p){let{slots:a,attrs:v}=p;const f=L(e,v),i=P(()=>{var u;return e.active||((u=f.isActive)==null?void 0:u.value)}),_=P(()=>i.value?e.activeColor:e.color),{textColorClasses:r,textColorStyles:n}=U(_);return q(()=>t(e.tag,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":i.value,"v-breadcrumbs-item--disabled":e.disabled,[`${e.activeClass}`]:i.value&&e.activeClass},r.value,e.class],style:[n.value,e.style],"aria-current":i.value?"page":void 0},{default:()=>{var u,h;return[f.isLink.value?t("a",{class:"v-breadcrumbs-item--link",href:f.href.value,"aria-current":i.value?"page":void 0,onClick:f.navigate},[((h=a.default)==null?void 0:h.call(a))??e.title]):((u=a.default)==null?void 0:u.call(a))??e.title]}})),{}}}),Se=x({activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:E,items:{type:Array,default:()=>[]},...D(),...O(),...W(),...F({tag:"ul"})},"VBreadcrumbs"),we=I()({name:"VBreadcrumbs",props:Se(),setup(e,p){let{slots:a}=p;const{backgroundColorClasses:v,backgroundColorStyles:f}=G(y(e,"bgColor")),{densityClasses:i}=H(e),{roundedClasses:_}=J(e);K({VBreadcrumbsDivider:{divider:y(e,"divider")},VBreadcrumbsItem:{activeClass:y(e,"activeClass"),activeColor:y(e,"activeColor"),color:y(e,"color"),disabled:y(e,"disabled")}});const r=P(()=>e.items.map(n=>typeof n=="string"?{item:{title:n},raw:n}:{item:n,raw:n}));return q(()=>{const n=!!(a.prepend||e.icon);return t(e.tag,{class:["v-breadcrumbs",v.value,i.value,_.value,e.class],style:[f.value,e.style]},{default:()=>{var u;return[n&&t("li",{key:"prepend",class:"v-breadcrumbs__prepend"},[a.prepend?t(Y,{key:"prepend-defaults",disabled:!e.icon,defaults:{VIcon:{icon:e.icon,start:!0}}},a.prepend):t(T,{key:"prepend-icon",start:!0,icon:e.icon},null)]),r.value.map((h,d,C)=>{var c;let{item:b,raw:g}=h;return t(M,null,[((c=a.item)==null?void 0:c.call(a,{item:b,index:d}))??t(Be,Z({key:d,disabled:d>=C.length-1},typeof b=="string"?{title:b}:b),{default:a.title?()=>{var s;return(s=a.title)==null?void 0:s.call(a,{item:b,index:d})}:void 0}),d<C.length-1&&t(Ce,null,{default:a.divider?()=>{var s;return(s=a.divider)==null?void 0:s.call(a,{item:g,index:d})}:void 0})])}),(u=a.default)==null?void 0:u.call(a)]}})}),{}}});const R=e=>(ce("data-v-d6417aec"),e=e(),de(),e),Pe={colspan:"2",class:"d-flex justify-center"},xe=R(()=>o("tr",null,[o("br")],-1)),De={class:"d-flex justify-center"},Ie={class:"my-2"},qe={style:{"white-space":"pre"}},Re=R(()=>o("h1",{class:"text-h1 text-red"},"已下架",-1)),$e=R(()=>o("br",null,null,-1)),Ae={__name:"ProductDetail",setup(e){const p=Q(),a=X(),{api:v,apiAuth:f}=ie(),i=ee(),_=ae(),r=$({_id:"",name:"",price:0,description:"",images:[],sell:!0,category:""}),n=fe({quantity:be().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:u,handleSubmit:h}=me({validationSchema:n,initialValues:{quantity:1}}),d=ve("quantity"),C=h(async g=>{var c,s;if(!_.isLogin){a.push("/login");return}try{const{data:m}=await f.patch("/users/cart",{product:r.value._id,quantity:g.quantity});_.cart=m.result,i({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(m){const N=((s=(c=m==null?void 0:m.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";i({text:N,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),b=$([]);return te(async()=>{var g,c;try{const{data:s}=await v.get("/products/"+p.params.id);r.value._id=s.result._id,r.value.name=s.result.name,r.value.price=s.result.price,r.value.description=s.result.description,r.value.images=s.result.images,r.value.sell=s.result.sell,r.value.category=s.result.category,document.title=`發記冰品 | ${r.value.name}`,b.value=[{title:"首頁",disabled:!1,href:"/"},{title:"快速預訂",disabled:!1,href:"/product#/product"},{title:`${r.value.name}`,disabled:!0,href:"/product#/product/"}]}catch(s){const m=((c=(g=s==null?void 0:s.response)==null?void 0:g.data)==null?void 0:c.message)||"發生錯誤，請稍後再試";i({text:m,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}}),a.push("/")}}),(g,c)=>{const s=se("font");return re(),le(M,null,[t(pe,null,{default:l(()=>[t(ge,null,{default:l(()=>[t(w,{cols:"12"},{default:l(()=>[t(we,{items:b.value},{divider:l(()=>[t(T,{icon:"mdi-chevron-right"})]),_:1},8,["items"])]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[t(_e,null,{default:l(()=>[o("tr",null,[o("td",Pe,[t(B,{width:350,height:350,"aspect-ratio":"1/1",cover:"",src:r.value.images[0]},null,8,["src"])])]),xe,o("tr",De,[o("td",null,[t(B,{width:70,height:70,"aspect-ratio":"1/1",class:"ma-2 pa-2",src:r.value.images[1]},null,8,["src"])]),o("td",null,[t(B,{width:70,height:70,"aspect-ratio":"1/1",class:"ma-2 pa-2",src:r.value.images[2]},null,8,["src"])])])]),_:1})]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[o("h2",null,[t(s,{color:"#D92323"},{default:l(()=>[k("【人氣商品】")]),_:1}),k(" "+S(r.value.name),1)]),t(he),o("p",Ie,"售價"+S(r.value.price),1),o("p",qe,S(r.value.description),1),t(ye,{disabled:V(u),onSubmit:ne(V(C),["prevent"])},{default:l(()=>[t(ue,{type:"number",min:"0",modelValue:V(d).value.value,"onUpdate:modelValue":c[0]||(c[0]=m=>V(d).value.value=m),modelModifiers:{number:!0},"error-messages":V(d).errorMessage.value,density:"confortable",variant:"outlined",placeholder:"數量",style:{width:"570px"}},null,8,["modelValue","error-messages"]),t(A,{type:"submit","prepend-icon":"mdi-cart",loading:V(u),style:{width:"570px"},color:"seventh"},{default:l(()=>[k("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),t(oe,{class:"align-center justify-center text-center","model-value":!r.value.sell,persistent:""},{default:l(()=>[Re,$e,t(A,{to:"/",color:"third"},{default:l(()=>[k("回首頁")]),_:1})]),_:1},8,["model-value"])],64)}}},Oe=z(Ae,[["__scopeId","data-v-d6417aec"]]);export{Oe as default};
